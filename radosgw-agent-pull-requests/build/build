#!/bin/bash

# the following two methods exist in scripts/build_utils.sh
pkgs=( "ansible" "tox" )
install_python_packages "pkgs[@]"


# run ansible to get this current host to meet our requirements, specifying
# a local connection and 'localhost' as the host where to execute. This might look
# odd because we are using ceph-deploy playbooks. But the requirements are the same
cd "$WORKSPACE/ceph-build/ceph-deploy-pull-requests/setup/playbooks"
$VENV/ansible-playbook -i "localhost," -c local setup.yml


# create the build with tox
cd $WORKSPACE/radosgw-agent
$VENV/tox -rv
